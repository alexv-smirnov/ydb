# Generated by devtools/yamaker from nixpkgs 22.05.

LIBRARY()

LICENSE(BSL-1.0)

LICENSE_TEXTS(.yandex_meta/licenses.list.txt)

OWNER(
    g:cpp-contrib
    g:taxi-common
)

VERSION(1.81.0)

ORIGINAL_SOURCE(https://github.com/boostorg/atomic/archive/boost-1.81.0.tar.gz)

PEERDIR(
    contrib/restricted/boost/align
    contrib/restricted/boost/assert
    contrib/restricted/boost/config
    contrib/restricted/boost/predef
    contrib/restricted/boost/preprocessor
    contrib/restricted/boost/static_assert
    contrib/restricted/boost/type_traits
    contrib/restricted/boost/winapi
)

IF (OS_WINDOWS)
    SRCS(
        src/wait_on_address.cpp
    )
ELSE()
    ADDINCL(
        contrib/restricted/boost/winapi/include
    )
ENDIF()

ADDINCL(
    GLOBAL contrib/restricted/boost/atomic/include
    contrib/restricted/boost/atomic/src
)

NO_COMPILER_WARNINGS()

NO_UTIL()

CFLAGS(
    -DBOOST_ATOMIC_SOURCE
)

IF (DYNAMIC_BOOST)
    CFLAGS(
        GLOBAL -DBOOST_ATOMIC_DYN_LINK
    )
ENDIF()

SRCS(
    src/find_address_sse2.cpp
    src/lock_pool.cpp
)

IF (USE_SSE4)
    CFLAGS(
        -DBOOST_ATOMIC_USE_SSE41
    )
    SRCS(
        src/find_address_sse41.cpp
    )
ENDIF()

END()
